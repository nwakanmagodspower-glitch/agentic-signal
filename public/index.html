<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AGENTIC AI // LIVE SIGNALS</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700;800&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #00ff41; --glow: rgba(0, 255, 65, 0.5); --dark: #050505; --red: #ff003c; }
        
        body { 
            margin: 0; background: #000; color: #fff; font-family: 'Rajdhani', sans-serif; 
            min-height: 100vh; overflow-x: hidden;
            display: flex; flex-direction: column; align-items: center;
            -webkit-tap-highlight-color: transparent; /* Mobile friendly tap */
        }

        /* ANIMATED BACKGROUND */
        .video-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; opacity: 0.3; filter: blur(5px); z-index: -1;
        }

        /* --- MOBILE CENTERED UI --- */
        #lock-screen {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-height: 100vh; width: 100%;
            padding: 15px; box-sizing: border-box;
        }

        .glass-panel {
            background: rgba(10, 15, 10, 0.9); backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 255, 65, 0.3); box-shadow: 0 0 40px var(--glow);
            padding: 20px; width: 100%; max-width: 420px; border-radius: 16px; text-align: center;
        }

        .status-dot { height: 10px; width: 10px; background: var(--primary); border-radius: 50%; display: inline-block; box-shadow: 0 0 10px var(--primary); animation: pulse 1s infinite; }
        h1 { font-family: 'Share Tech Mono', monospace; font-size: 2rem; margin: 10px 0; text-shadow: 0 0 20px var(--primary); line-height: 1; }
        
        /* PRICING GRID - MOBILE STACKED */
        .pricing-grid { 
            display: flex; flex-direction: column; gap: 10px; margin: 20px 0; 
        }

        .price-card { 
            background: rgba(255,255,255,0.03); border: 1px solid #333; 
            padding: 12px 15px; border-radius: 8px; text-align: left;
            transition: 0.2s; position: relative; overflow: hidden;
        }
        
        /* Highlight the VIP Card */
        .price-card.vip { 
            border: 1px solid var(--primary); 
            background: rgba(0, 255, 65, 0.05); 
            box-shadow: 0 0 15px rgba(0,255,65,0.1); 
        }
        
        .tier-name { font-family: 'Share Tech Mono'; color: #fff; font-size: 1.1rem; letter-spacing: 1px; display: flex; justify-content: space-between; }
        .tier-price { color: var(--primary); font-weight: bold; }
        .tier-benefits { font-size: 0.85rem; color: #aaa; margin-top: 6px; line-height: 1.4; }
        .check { color: var(--primary); margin-right: 5px; font-weight: bold; }
        .cross { color: var(--red); margin-right: 5px; font-weight: bold; }

        /* DEPOSIT BUTTON (Thumb Friendly) */
        .btn-main {
            background: linear-gradient(180deg, #00ff41, #008f11); color: #000; border: none;
            padding: 18px; width: 100%; font-size: 1.1rem; font-weight: 800; text-transform: uppercase;
            border-radius: 8px; box-shadow: 0 0 25px var(--glow); cursor: pointer; transition: 0.2s;
            margin-top: 10px; letter-spacing: 1px;
            touch-action: manipulation;
        }
        .btn-main:active { transform: scale(0.98); }

        /* ALERT BUTTON */
        .btn-alert {
            background: transparent; border: 1px solid #333; color: #fff;
            padding: 12px; width: 100%; font-size: 0.8rem; margin-top: 10px;
            border-radius: 6px; cursor: pointer; opacity: 0.7;
        }
        .btn-alert:active { background: rgba(255,255,255,0.1); }

        /* --- DASHBOARD --- */
        #dashboard { display: none; width: 100%; max-width: 600px; padding: 15px; box-sizing: border-box; }
        
        .dash-header { 
            display: flex; justify-content: space-between; align-items: center; 
            background: rgba(0,0,0,0.8); padding: 15px; border-radius: 10px; border: 1px solid #333; margin-bottom: 20px;
        }
        .tier-badge { padding: 5px 12px; border-radius: 20px; font-family: 'Share Tech Mono'; font-weight: bold; font-size: 12px; background: #333; border: 1px solid #555; }
        .tier-1 { color: #fff; } 
        .tier-2 { color: #ffd700; border-color: #ffd700; } 
        .tier-3 { background: var(--primary); color: #000; box-shadow: 0 0 10px var(--primary); }

        /* SIGNAL CARDS */
        .signal-card { 
            background: rgba(20, 20, 20, 0.9); border-left: 4px solid #555; 
            padding: 15px; margin-bottom: 12px; border-radius: 6px; position: relative; overflow: hidden;
            animation: slideIn 0.5s ease;
        }
        .signal-card.call { border-left-color: var(--primary); }
        .signal-card.put { border-left-color: var(--red); }
        .signal-header { display: flex; justify-content: space-between; font-size: 1rem; font-weight: bold; margin-bottom: 5px; }
        .decision { font-size: 1.6rem; font-weight: 800; margin: 5px 0; text-shadow: 0 0 10px rgba(0,0,0,0.5); }
        .call .decision { color: var(--primary); }
        .put .decision { color: var(--red); }

        .blur-overlay { 
            position: absolute; top:0; left:0; width:100%; height:100%; 
            background: rgba(0,0,0,0.85); backdrop-filter: blur(5px);
            display: flex; align-items: center; justify-content: center; flex-direction: column; z-index: 10; 
            text-align: center;
        }

        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }
        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
    
    <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script>
    <script>
      window.OneSignal = window.OneSignal || [];
      OneSignal.push(function() {
        OneSignal.init({ 
            appId: "3552e19d-e987-49b0-8885-e09175dcc1c9",
            notifyButton: { enable: false }, 
        });
      });
    </script>
</head>
<body>

    <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExYnJ2ZmV3bnZ5cWJ6eXJ6eXJ6eXJ6eXJ6eXJ6eXJ6eXJ6eXJ6eCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/L1R1TVThqcebPqF8M/giphy.gif" class="video-bg" alt="bg">

    <div id="lock-screen">
        <div class="glass-panel">
            <div><span class="status-dot"></span> SYSTEM ONLINE</div>
            <h1>AGENTIC AI</h1>
            
            <div class="pricing-grid">
                
                <div class="price-card">
                    <div class="tier-name">BASIC <span class="tier-price">$25 - $99</span></div>
                    <div class="tier-benefits">
                        <span class="check">âœ“</span> Forex Majors Only<br>
                        <span class="cross">âœ—</span> <b>No Crypto / Gold</b><br>
                        <span class="cross">âœ—</span> Standard Speed
                    </div>
                </div>

                <div class="price-card">
                    <div class="tier-name">PRO <span class="tier-price">$100 - $499</span></div>
                    <div class="tier-benefits">
                        <span class="check">âœ“</span> All Forex Pairs<br>
                        <span class="check">âœ“</span> <b>High Accuracy (90%)</b><br>
                        <span class="cross">âœ—</span> No Gold Signals
                    </div>
                </div>

                <div class="price-card vip">
                    <div class="tier-name">VIP <span class="tier-price">$500+</span></div>
                    <div class="tier-benefits">
                        <span class="check">âœ“</span> <b>GOLD (OTC) & BITCOIN</b><br>
                        <span class="check">âœ“</span> <b>Institutional Data</b><br>
                        <span class="check">âœ“</span> 0ms Latency
                    </div>
                </div>

            </div>

            <button class="btn-main" onclick="register()">âš¡ DEPOSIT TO UNLOCK</button>
            <button class="btn-alert" onclick="enableAlerts()">ðŸ”” ENABLE NOTIFICATIONS</button>
            <p style="font-size:10px; color:#555; margin-top:5px;">iPhone Users: Tap 'AA' > Open in Browser</p>
        </div>
    </div>

    <div id="dashboard">
        <div class="dash-header">
            <span style="font-weight:bold; color:#fff;">ðŸ”´ LIVE FEED</span>
            <div id="my-tier" class="tier-badge tier-1">TIER 0 (LOCKED)</div>
        </div>
        <div id="feed"></div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let userId = localStorage.getItem('u_id');
        if(!userId) {
            userId = 'user_' + Math.floor(Math.random() * 1000000);
            localStorage.setItem('u_id', userId);
        }

        let currentTier = 0; 
        
        async function register() {
            const btn = document.querySelector('.btn-main');
            btn.innerText = "GENERATING LINK...";
            try {
                const res = await fetch(`/generate-link?userId=${userId}`);
                const data = await res.json();
                window.open(data.link, '_blank');
                btn.innerText = "WAITING FOR DEPOSIT...";
            } catch(e) {
                alert("Error connecting to server.");
                btn.innerText = "TRY AGAIN";
            }
        }

        function enableAlerts() {
            OneSignal.push(function() {
                OneSignal.showNativePrompt();
            });
            alert("Checking permission... If no popup appears, tap '...' and Open in Chrome/Safari.");
        }

        socket.on('account_unlocked', (data) => { 
            updateTier(data.tier, data.message); 
        });
        
        function updateTier(tier, msg) {
            currentTier = tier;
            document.getElementById('lock-screen').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            
            const badge = document.getElementById('my-tier');
            badge.innerText = "TIER " + currentTier;
            badge.className = "tier-badge tier-" + currentTier;
            
            alert("ðŸ”“ " + msg);
        }

        socket.on('new_signal', (data) => {
            const feed = document.getElementById('feed');
            const div = document.createElement('div');
            const isCall = data.decision.includes('CALL') || data.decision.includes('Buy');
            const isLocked = data.tierRequired > currentTier;
            
            div.className = `signal-card ${isCall ? 'call' : 'put'}`;
            
            // Updated Logic: Shows $500 for VIP or $100 for Pro
            const depositAmount = data.tierRequired === 3 ? '500' : '100';
            
            div.innerHTML = `
                ${isLocked ? `<div class="blur-overlay"><span>ðŸ”’ VIP SIGNAL</span><small style="color:#aaa">Requires Tier ${data.tierRequired}</small><br><small style="color:#00ff41">Deposit $${depositAmount} to view</small></div>` : ''}
                <div class="signal-header">
                    <span>${data.pair}</span>
                    <span style="font-size:0.8rem; opacity:0.7">${data.timestamp}</span>
                </div>
                <div class="decision">${data.decision}</div>
                <div style="display:flex; justify-content:space-between; font-size:0.8rem; color:#ccc;">
                    <span>Entry: ${data.price}</span>
                    <span>RSI: ${data.rsi}</span>
                </div>
            `;
            
            feed.prepend(div);
            if(feed.children.length > 10) feed.lastChild.remove();
        });
    </script>
</body>
</html>